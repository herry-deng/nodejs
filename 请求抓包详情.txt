>> 本文件内容为 https://ciiom-sit.hsbc.com.hk:443/mauth/api/v2/auth/bind?aid=mobileciiom&locale=en-US 的请求抓包详情，供您分析和定位问题。

1. 请求内容 Request:

POST /mauth/api/v2/auth/bind?aid=mobileciiom&locale=en-US HTTP/1.1
Host: ciiom-sit.hsbc.com.hk:443
X-HSBC-Locale: en_GB
language: en_GB
User-Agent: CIIOM/3.48.0 (iPhone; iOS 17.4.1; Scale/3.00)
x-hsbc-session-correlation-id: B69HaFAO
xHsbcMobileRaspDetails: eyJob29raW5nRnJhbWV3b3JrcyI6IjAiLCJkZWJ1Z2dlckF0dGFjaGVkIjoiMCIsInJvb3RpbmdQcm9iYWJpbGl0eSI6MCwiYXBwbGljYXRpb25SZXBhY2thZ2VkIjoiMCIsInVudHJ1c3RlZFNjcmVlblJlYWRlcnMiOiIwIiwiZW11bGF0b3JSdW5uaW5nIjoiMCIsIm5hdGl2ZUNvZGVIb29rcyI6IjAiLCJ1bnRydXN0ZWRLZXlib2FyZCI6IjAiLCJkZXZpY2VKYWlsQnJva2VuIjoiMCJ9
useragent: com.hsbc.ciiom.enterprise.hsbcciiom.dev/3.48.0 / iOS 17.4.1; iPhone14,2
fraudSessionId: 879958950803564610738548164522
Cookie: ts_hwid=f8ad0ed7-dd96-436a-aebb-e8f6ecd0ae0a; HTTPS-CIIOM-CB-TRANSMIT-WS-443=!0HOHa8Z/6nAa0BuxdsPGax06Ct8tBjSV4lYpcynBqMPT6xoY8F6yefMICIN3hxkr8jPBaudNooWw; TS01f477b4=0199e0537f955c457ba4dad08b94d8848117157f01231022d40f54037e949c236de3a091d724398befe501053505e6f3a8aae9a542
ADRUM_1: isMobile:true
channel: MOBILE
appVersion: 3.48.0
X-HSBC-Global-Channel-Id: MOBILE
X-TS-Client-Version: 6.1.14;[1,2,3,6,7,8,10,11,12,14,28,19]
countrycode: GB
groupmembercode: HBEU
xHsbcMobileAppMetaData: eyJpbXNpU2VyaWFsSUQiOiIiLCJncHNMb2NhdGlvbkVuYWJsZWQiOiIwIiwiYXBwVmVyc2lvbk5hbWUiOiIxMTEyNDEiLCJtb2JpbGVEZXZpY2VQcmludCI6IjAxNDlBREI0MkI4M0NBNDE0RkFBOEU4OTEyRkJDNTU5Q0UiLCJhcHBOYW1lIjoiQ0lJT00iLCJvc1ZlcnNpb24iOiJpT1MgMTcuNC4xIiwic2FuY3Rpb25DaGVjayI6IjAiLCJibHVldG9vdGhDb25uRGV2aWNlcyI6IiIsImJsdWV0b290aERldGVjdGVkTGlzdCI6IiIsIndpZmlTdGF0dXMiOiIwIiwid2lmaUJTU0lEQ29ubmVjdGVkIjoiIiwiYXBwVmVyc2lvbkNvZGUiOiIzLjQ4LjAgKDExMTI0MSkiLCJkZXZpY2VUeXBlIjoiaVBob25lMTcuNC4xIiwiZ3BzTG9uZ0xhdCI6MCwiZGF0YU5ldHdvcmtOYW1lIjoiLS0iLCJtY2MiOiI2NTUzNSIsIndpZmlOZXR3b3Jrc0luUmFuZ2UiOiIiLCJsb2NhdGlvbiI6IkNpdHkiLCJncHNMb25nTG9uZyI6MCwidGltZVpvbmUiOjgsImJsdWV0b290aEVuYWJsZWQiOiIwIiwiZGF0YUVuYWJsZWQiOiIwIn0=
requestcorrelationid: StjIE1aQ
X-HSBC-Channel-Id: MOBILE
lineOfBusiness: rbwm
e2ealgorithm: SHA256
X-HSBC-MAC-Address: 49ADB42B-83CA-414F-AA8E-8912FBC559CE
Content-Length: 7864
Connection: keep-alive
Authorization: TSToken d881be66-3cf6-48d7-ac5e-5c32fede5983; tid=mobileciiom_token
Accept-Language: zh-Hans-CN;q=1, en-CN;q=0.9
ADRUM: isAjax:true
Accept: */*
Content-Type: application/json
Accept-Encoding: gzip, deflate, br

{"headers":[{"type":"flow_id","flow_id":"e0010397632657bc75b47e3085dec903f48307c173dd28f0ea1de33978fe1630"},{"type":"uid","uid":"IB1103640348"}],"data":{"collection_result":{"content":{"device_details":{"logged_users":0,"persistence_mode":"","biometric_db_hash":"","keychain_err_logs":"1717126982.123746_N/A_rsaEncryptionEnabled_generateKeyPairSuccess,1717126982.044223_N/A_rsaEncryptionEnabled_getKey-private: errSecItemNotFound,1717126982.033459_N/A_rsaEncryptionEnabled_getKey-public: errSecItemNotFound,1717126982.023647_N/A_ecEncryptionEnabled_getKey-private: errSecItemNotFound,1717126982.013611_N/A_ecEncryptionEnabled_getKey-public: errSecItemNotFound,1717126982.003803_N/A_rsa_getKey-private: errSecItemNotFound,1717126981.994038_N/A_rsa_getKey-public: errSecItemNotFound,1717126981.984253_N/A_ec_getKey-private: errSecItemNotFound,1717126981.974171_N/A_ec_getKey-public: errSecItemNotFound,1717126981.964442_N/A_rsa_getKey-private: errSecItemNotFound,1717126981.954706_N/A_rsa_getKey-public: errSecItemNotFound,1717126981.944899_N/A_ec_getKey-private: errSecItemNotFound,1717126981.935036_N/A_ec_getKey-public: errSecItemNotFound,1717126981.923423_N/A_ecTarsusStdSigning_generateKeyPairSuccess,1717126981.900894_N/A_rsaTarsusStdSigning_getKey-private: errSecItemNotFound,1717126981.891369_N/A_rsaTarsusStdSigning_getKey-public: errSecItemNotFound,1717126981.881494_N/A_ecTarsusStdSigning_getKey-private: errSecItemNotFound,1717126981.871857_N/A_ecTarsusStdSigning_getKey-public: errSecItemNotFound,1717126981.862305_N/A_rsaTarsusStdSigning_getKey-private: errSecItemNotFound,1717126981.852812_N/A_rsaTarsusStdSigning_getKey-public: errSecItemNotFound,1717126981.842752_N/A_ecTarsusStdSigning_getKey-private: errSecItemNotFound,1717126981.833128_N/A_ecTarsusStdSigning_getKey-public: errSecItemNotFound,1717126981.766047_N/A_rsa_getKey-private: errSecItemNotFound,1717126981.756567_N/A_rsa_getKey-public: errSecItemNotFound,1717126981.747119_N/A_ec_getKey-private: errSecItemNotFound,1717126981.737690_N/A_ec_getKey-public: errSecItemNotFound,1717126981.726362_N/A_ec_getKey-private: errSecItemNotFound,1717126981.716765_N/A_ec_getKey-public: errSecItemNotFound,1717126981.706658_N/A_ec_getKey-private: errSecItemNotFound,1717126981.697312_N/A_ec_getKey-public: errSecItemNotFound,1717126981.688088_N/A_rsa_getKey-private: errSecItemNotFound,1717126981.678692_N/A_rsa_getKey-public: errSecItemNotFound,1717126981.669293_N/A_ec_getKey-private: errSecItemNotFound,1717126981.659352_N/A_ec_getKey-public: errSecItemNotFound,1717126981.650006_N/A_rsa_getKey-private: errSecItemNotFound,1717126981.640738_N/A_rsa_getKey-public: errSecItemNotFound,1717126981.630376_N/A_ec_getKey-private: errSecItemNotFound,1717126981.621290_N/A_ec_getKey-public: errSecItemNotFound,1717126981.611575_N/A_rsa_getKey-private: errSecItemNotFound,1717126981.602458_N/A_rsa_getKey-public: errSecItemNotFound,1717126981.593245_N/A_ec_getKey-private: errSecItemNotFound,1717126981.584109_N/A_ec_getKey-public: errSecItemNotFound,1717126981.574935_N/A_rsa_getKey-private: errSecItemNotFound,1717126981.565795_N/A_rsa_getKey-public: errSecItemNotFound,1717126981.556678_N/A_ec_getKey-private: errSecItemNotFound,1717126981.547502_N/A_ec_getKey-public: errSecItemNotFound,1717126981.538249_N/A_rsa_getKey-private: errSecItemNotFound,1717126981.527902_N/A_rsa_getKey-public: errSecItemNotFound,1717126981.516113_N/A_ec_getKey-private: errSecItemNotFound,1717126981.502110_N/A_ec_getKey-public: errSecItemNotFound,1717126786.287692_N/A_rsaEncryptionEnabled_generateKeyPairSuccess,1717126786.225610_N/A_rsaEncryptionEnabled_getKey-private: errSecItemNotFound,1717126786.216753_N/A_rsaEncryptionEnabled_getKey-public: errSecItemNotFound,1717126786.207928_N/A_ecEncryptionEnabled_getKey-private: errSecItemNotFound,1717126786.198997_N/A_ecEncryptionEnabled_getKey-public: errSecItemNotFound,1717126786.190175_N/A_rsa_getKey-private: errSecItemNotFound,1717126786.181251_N/A_rsa_getKey-public: errSecItemNotFound,1717126786.172224_N/A_ec_getKey-private: errSecItemNotFound,1717126786.163216_N/A_ec_getKey-public: errSecItemNotFound,1717126786.154284_N/A_rsa_getKey-private: errSecItemNotFound,1717126786.145392_N/A_rsa_getKey-public: errSecItemNotFound,1717126786.136471_N/A_ec_getKey-private: errSecItemNotFound,1717126786.126953_N/A_ec_getKey-public: errSecItemNotFound,1717126786.108531_N/A_ecTarsusStdSigning_generateKeyPairSuccess,1717126786.036329_N/A_rsaTarsusStdSigning_getKey-private: errSecItemNotFound,1717126786.027635_N/A_rsaTarsusStdSigning_getKey-public: errSecItemNotFound,1717126786.018973_N/A_ecTarsusStdSigning_getKey-private: errSecItemNotFound,1717126786.010144_N/A_ecTarsusStdSigning_getKey-public: errSecItemNotFound,1717126786.001300_N/A_rsaTarsusStdSigning_getKey-private: errSecItemNotFound,1717126785.992456_N/A_rsaTarsusStdSigning_getKey-public: errSecItemNotFound,1717126785.982852_N/A_ecTarsusStdSigning_getKey-private: errSecItemNotFound,1717126785.973484_N/A_ecTarsusStdSigning_getKey-public: errSecItemNotFound","tampered":true,"jailbroken":false,"screen_lock":true,"tz":"Asia/Shanghai","application_state":"active","has_hw_security":true,"sflags":-1,"hw_type":"iPhone","device_name":"867e57bd062c7169995dc03cc0541c19","sim_operator_name":"--","connection":"wifi: 192.168.0.103","device_id":"2BB6EF6B-5D15-4823-AB7A-FEB8151DC7AB","os_version":"17.4.1","sim_operator":"6553565535","os_type":"iPhone","device_model":"iPhone14,2"},"installed_packages":[],"hw_authenticators":{"fido":[{"aaid":"1206#0001"},{"aaid":"1206#0002"},{"aaid":"1206#0003"}],"fingerprint":{"supported":"false","user_registered":"false"},"face_id":{"supported":"true","user_registered":"false"},"device_biometrics":{"supported":"false","user_registered":"false"}},"capabilities":{"fido2_user_verifying_platform_authenticator_available":false,"audio_acquisition_supported":false,"finger_print_supported":false,"image_acquisition_supported":true,"persistent_keys_supported":true,"face_id_key_bio_protection_supported":true,"fido_client_present":false,"fido2_client_present":false,"dyadic_present":false,"installed_plugins":[],"host_provided_features":"19"},"collector_state":{"accounts":"disabled","devicedetails":"active","contacts":"disabled","owner":"disabled","software":"active","location":"disabled","locationcountry":"active","bluetooth":"active","externalsdkdetails":"active","hwauthenticators":"active","capabilities":"active","fidoauthenticators":"active","largedata":"active","localenrollments":"active","devicefingerprint":"active","apppermissions":"active"},"local_enrollments":{}},"metadata":{"timestamp":1717126982.243639}},"public_key":{"key":"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/SonAA0G7mqT697aS0Pblj4Fp2Md5350qL/4kAlewplDM7+f39igh7icOUFwdnJtFDPate3GlJsZKrI7Pf74tg==","type":"ec"},"encryption_public_key":{"key":"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx+ZbDvagLKgiyWtHcbzKR3yQHnb9Eovk9NmOsHNrnW+ki5hRSwpAs9NEkpwGTM0I16F3sh5UZrWOtNcg7terPhSQVNE4IfeDSg9SCQkaZHli6BAFYTgmJAyN1Ivt9SIX0WH3DsWq7uuyje0uP3U1ENpbsZIKpnyQxJ50fMe/nGcBY+eiOkZaWImFytKJIKkCVIXB3mjcAiEnpLz+pjPjaH5KzHk4pc8VUIy9LgJYdDx7OZOKPmAlFG9LoDlsTGRM81it9UnyamB9nZT93ueg6IThO/s2b7Ds8+z0ah7A4YH8pENjhe8OxkgSlOhjWWlePnV2KtJMC2OPUyvl8qLLNQIDAQAB","type":"rsa"},"params":{"enableSmsOtpTimeout":false,"enableUsernameEnumeration":0,"deviceModelName":"iPhone/13 Pro","isTDSOTPSupported":true,"enableCfcaCert":false,"mAuthSdkVersion":232,"enable3FactorAuthentication":false,"isDspAuthSupported":false,"skipCAM30EnforceOFR":false,"credentialEncryptionRequired":"false","dobAuthSupported":false,"enableResetMAuthOTP":true,"showTotpOnBoardingPage":true,"isLocationPermission":false,"enableSMSEmailOTP":false,"isLogonOTPSupported":true,"enableOTPEnhancement":false,"isReauthOTPSupported":true,"fpSupported":false,"skipSecurityQnA":false,"enableMAuth2":true,"enableDIVAAuthenticate":false,"entityTimeZone":"Asia/Shanghai"}}}

2. 响应内容 Response:

HTTP/1.1 200 OK
Date: Fri, 31 May 2024 03:43:02 GMT
X-Frame-Options: SAMEORIGIN
Strict-Transport-Security: max-age=16070400; includeSubDomains
Pragma: no-cache
Cache-Control: no-cache, must-revalidate, no-store
Content-Type: application/json
Content-Length: 1830
Set-Cookie: ts_hwid=f8ad0ed7-dd96-436a-aebb-e8f6ecd0ae0a; Expires=Sat, 31 May 2025 03:43:03 GMT; Path=/; Secure; HttpOnly; SameSite=none
S: reverseproxy-hkg1vl0867
X-Content-Type-Options: nosniff
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Set-Cookie: TS01f477b4=0199e0537f955c457ba4dad08b94d8848117157f01231022d40f54037e949c236de3a091d724398befe501053505e6f3a8aae9a542; Path=/

{"error_code":0,"error_message":"","data":{"data":{"json_data":{"e2ePublicKey":"-----BEGIN PUBLIC KEY----- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuaBVpargXIWtWSUq619c aihd+EoDKT2d3GRhmcMvTRBkm8IoLuFmO8yfpPKQrf/kPquFCxS/5XDxOqll5v4C suxKIuIT8KGlRYApr2LZ5w6/InCOD5C3FqtVeLhlHC/OawgI1YpWg7NYdo4ftyKN 5/egubzlMEYanXo+bu7oGw2EwmOlD2ViJvN5BP9Y+osXeO+Z7upYfLVvMUP60c/x uzmKY0wcHPqxcuZTojGG3ZU8mJQXChZXyP4KQVqJ5tfG+QdJQCLOvpDohGSQ3jK/ j8aUqKrDxcXDIb+zgo5/Pp4bVbTrxXgrSDFC4op2FJvVOEqHPMeD6vPfyPOd/9Bs DwIDAQAB -----END PUBLIC KEY-----","enableDIVAAuthenticate":0,"username_response":{"showInterstitialPage":false,"authPreference":"30","otpauthAllowed":false,"pwdRequiredDosi":false,"gracePeriodExpired":true,"transactionSigningAbilityLocked":false,"otpRequiredDosi":false,"otpRequiredMemorableAnswer":false,"dspUser":true,"userSuspended":false,"isOlrSetup":true,"passwordAuthAllowed":true,"tdsRequiredDosi":false,"otpOrderType":13,"failedReAuthCount":0,"cam40OnlyCountry":true,"pwdLocked":false,"memorableAnswerAuthAllowed":true,"fraudSessionId":"513925653472801831413769773541","suspendReason":-1,"remainingPwdAttempts":4,"dosilocked":false,"memorableAnswerLocked":false,"invalidTransactionSigningCount":0,"otplocked":false,"tokenOrderExists":true,"reauthLocked":false,"isOlrLocked":false}}},"challenge":"atL+zPofQ+0Cwez6VXOgnNM+","state":"pending","control_flow":[{"methods":[{"last_used":1717126794966,"expired":false,"locked":false,"assertion_id":"pF9GiHhcgVjVMb4YfRCu1/nK","status":"registered","type":"password"}],"strings":{},"options":{"update_default":true,"start_with":"default"},"assertion_id":"","escapes":[],"type":"authentication"}],"assertions_complete":false},"headers":[{"session_id":"58b9ac25-d391-424c-87c7-58a55a5c44b2","type":"session_id"},{"device_id":"74d7ebdf-18cd-4c5e-b4af-1b98702877e3","type":"device_id"}]}

====
该记录由 Stream 抓取，仅用于分析和学习，可 AppStore 搜索『抓包』下载，面向开发者永久免费使用。
